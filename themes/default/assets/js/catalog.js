// Generated by CoffeeScript 1.6.3
(function() {
  $(function() {
    var catalog_events, changeCategory, filterListView;
    $.show_abaris_box('.login-form');
    if ($('.model-desc').length > 0) {
      $.show_abaris_box('.model-desc', {
        onUpdate: function() {
          return this.wrap.css('position', 'fixed');
        }
      });
    }
    if ($('.scroller').length > 0) {
      $('.scroller').baron({
        scroller: '.scroller',
        container: '.scroll-container',
        bar: '.scroller__bar',
        track: '.scroller__track',
        barOnCls: 'baron'
      });
    }
    $('.add-auto').on('click', function() {
      var item, modal;
      modal = $(this).closest('.inline-modal');
      item = modal.find('.auto-item').eq(0).clone().addClass('clone-auto');
      item.find('input').val('');
      modal.find('.auto-items').append(item);
      return $.fancybox.reposition();
    });
    filterListView = function(listId) {
      var form;
      form = $("#" + listId).parent().find('.catalog-grid-header form');
      if (form.size() === 0) {
        return false;
      }
      form.submit(function() {
        $.fn.yiiListView.update("" + listId, {
          data: $(this).serialize()
        });
        $.scrollTo('#top-grid');
        return false;
      });
      return form.find('input:text').keyup(function(e) {
        form.submit();
        return false;
      });
    };
    catalog_events = function() {
      if ($('.catalog-grid-row').size() > 0) {
        $('.catalog-grid-header.scroll-fixed').scrollToFixed({
          limit: 0
        });
      }
      $('.list-view').each(function() {
        return filterListView($(this).attr('id'));
      });
      $.bind_ajax_modal('#details-list .to_cart', {
        afterShow: function() {
          $('#cart-info').find('.cost').text(this.inner.find('#cost').val()).end().find('.count').text(this.inner.find('#quantity').val());
          return $('.close-button', this.inner).click(function(e) {
            $.fancybox.close();
            return false;
          });
        }
      });
      return $.bind_ajax_modal('.view_brand');
    };
    catalog_events();
    changeCategory = function() {
      return $('select.select_category').change(function(e) {
        $.ajax({
          url: window.location.href,
          type: 'GET',
          data: {
            cat: $(this).val(),
            prevRootCat: $(this).data('prev')
          },
          success: function(data) {
            $('.catalog-container').first().replaceWith(data);
            catalog_events();
            changeCategory();
            return filterListView('details-list');
          }
        });
        return false;
      });
    };
    $.bind_ajax_modal('a.send_question', {
      afterShow: function() {
        var content;
        content = $(this.inner);
        $(content).on('click', 'a.close-box', function(e) {
          $.fancybox.close();
          return false;
        });
        return $(content).on('click', 'button.next-step', function(e) {
          var form;
          form = $('form', content);
          $.ajax({
            url: form.attr('action'),
            type: 'POST',
            data: form.serialize(),
            success: function(data) {
              return content.html(data);
            }
          });
          return false;
        });
      }
    });
    return changeCategory();
  });

}).call(this);

/*
//@ sourceMappingURL=catalog.map
*/
