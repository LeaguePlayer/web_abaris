// Generated by CoffeeScript 1.6.3
(function() {
  $(function() {
    $.registration = function() {
      var bindEvents;
      bindEvents = function(context) {
        var form;
        $('.cancel-signup', context).click(function(e) {
          $.fancybox.close();
          return false;
        });
        $('.choose_usertype:radio', context).click(function(e) {
          if (parseInt($(this).val()) === 0) {
            return $('.organization', context).addClass('hidden');
          } else {
            return $('.organization', context).removeClass('hidden');
          }
        });
        $('.add-auto', context).click(function(e) {
          var autoBlock, counter, newBlock;
          autoBlock = $('.auto-item', context);
          counter = autoBlock.size() + 1;
          newBlock = autoBlock.first().clone().addClass('clone-auto');
          newBlock.find('.row-fluid').each(function() {
            var input;
            input = $(this).find('input').val('');
            input.attr('id', 'UserCars_' + input.data('attribute') + '-' + counter);
            input.attr('name', 'UserCars[' + counter + '][' + input.data('attribute') + ']');
            return $(this).find('label').attr('for', input.attr('id'));
          });
          autoBlock.last().after(newBlock);
          return false;
        });
        form = $('form', context);
        form.find('button.next-step, button.login-submit').click(function(e) {
          $.ajax({
            url: form.attr('action'),
            type: form.attr('method'),
            data: form.serialize(),
            success: function(data) {
              context.html(data);
              bindEvents(context);
              return $.fancybox.reposition();
            }
          });
          return false;
        });
        form.find('button.repeat-sms').click(function(e) {
          console.log($(this).attr('name'));
          $.ajax({
            url: form.attr('action'),
            type: form.attr('method'),
            data: {
              'UpdateSmsCode': 1
            },
            success: function(data) {
              context.html(data);
              bindEvents(context);
              return $.fancybox.reposition();
            }
          });
          return false;
        });
        form.find('.prev-step').click(function(e) {
          $.ajax({
            url: $(this).attr('href'),
            type: 'GET',
            success: function(data) {
              context.html(data);
              bindEvents(context);
              return $.fancybox.reposition();
            }
          });
          return false;
        });
        $.mask.definitions['d'] = "[0-9]";
        return form.find('#Profile_phone').mask("dddddddddd");
      };
      return $.bind_ajax_modal('.registrationButton', {
        afterShow: function() {
          return bindEvents($(this.inner));
        }
      });
    };
    return $.registration();
  });

}).call(this);

/*
//@ sourceMappingURL=sign_up.map
*/
